THREE.SVGObject=function(e){THREE.Object3D.call(this),this.node=e},THREE.SVGObject.prototype=Object.create(THREE.Object3D.prototype),THREE.SVGObject.prototype.constructor=THREE.SVGObject,THREE.SVGRenderer=function(){var e,i,t,o,r,n,s,a,c,l,p,d,E,f=this,h=new THREE.Projector,S=document.createElementNS("http://www.w3.org/2000/svg","svg"),y=new THREE.Box2,u=new THREE.Box2,m=new THREE.Color,x=new THREE.Color,v=new THREE.Color,R=new THREE.Color,g=new THREE.Color,w=new THREE.Color,b=new THREE.Vector3,T=new THREE.Vector3,H=new THREE.Vector3,M=new THREE.Matrix3,C=new THREE.Matrix4,z=new THREE.Matrix4,j=[],k=0,L=1,V=null;function P(){for(k=0;S.firstChild;)S.removeChild(S.firstChild)}function B(e){return null!==V?e.toFixed(V):e}function G(e,i,t){var o=i.scale.x*n,r=i.scale.y*s;t.isPointsMaterial&&(o*=t.size,r*=t.size);var a="M"+B(e.x-.5*o)+","+B(e.y-.5*r)+"h"+B(o)+"v"+B(r)+"h"+B(-o)+"z",c="";(t.isSpriteMaterial||t.isPointsMaterial)&&(c="fill:"+t.color.getStyle()+";fill-opacity:"+t.opacity),W(c,a)}function O(e,i,t,o){var r="M"+B(e.positionScreen.x)+","+B(e.positionScreen.y)+"L"+B(i.positionScreen.x)+","+B(i.positionScreen.y);if(o.isLineBasicMaterial){var n="fill:none;stroke:"+o.color.getStyle()+";stroke-opacity:"+o.opacity+";stroke-width:"+o.linewidth+";stroke-linecap:"+o.linecap;o.isLineDashedMaterial&&(n=n+";stroke-dasharray:"+o.dashSize+","+o.gapSize),W(n,r)}}function F(e,i,o,r,n){f.info.render.vertices+=3,f.info.render.faces++;var s="M"+B(e.positionScreen.x)+","+B(e.positionScreen.y)+"L"+B(i.positionScreen.x)+","+B(i.positionScreen.y)+"L"+B(o.positionScreen.x)+","+B(o.positionScreen.y)+"z";n.isMeshBasicMaterial?(m.copy(n.color),n.vertexColors!==THREE.FaceColors&&n.vertexColors!==THREE.VertexColors||m.multiply(r.color)):n.isMeshLambertMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial?(x.copy(n.color),n.vertexColors!==THREE.FaceColors&&n.vertexColors!==THREE.VertexColors||x.multiply(r.color),m.copy(v),T.copy(e.positionWorld).add(i.positionWorld).add(o.positionWorld).divideScalar(3),function(e,i,t,o){for(var r=0,n=e.length;r<n;r++){var s=e[r],a=s.color;if(s.isDirectionalLight){var c=b.setFromMatrixPosition(s.matrixWorld).normalize();if((l=t.dot(c))<=0)continue;l*=s.intensity,o.r+=a.r*l,o.g+=a.g*l,o.b+=a.b*l}else if(s.isPointLight){var l;c=b.setFromMatrixPosition(s.matrixWorld);if((l=t.dot(b.subVectors(c,i).normalize()))<=0)continue;if(0==(l*=0==s.distance?1:1-Math.min(i.distanceTo(c)/s.distance,1)))continue;l*=s.intensity,o.r+=a.r*l,o.g+=a.g*l,o.b+=a.b*l}}}(t,T,r.normalModel,m),m.multiply(x).add(n.emissive)):n.isMeshNormalMaterial&&(H.copy(r.normalModel).applyMatrix3(M).normalize(),m.setRGB(H.x,H.y,H.z).multiplyScalar(.5).addScalar(.5)),W(n.wireframe?"fill:none;stroke:"+m.getStyle()+";stroke-opacity:"+n.opacity+";stroke-width:"+n.wireframeLinewidth+";stroke-linecap:"+n.wireframeLinecap+";stroke-linejoin:"+n.wireframeLinejoin:"fill:"+m.getStyle()+";fill-opacity:"+n.opacity,s)}function A(e,i,t){var o,r=i.x-e.x,n=i.y-e.y,s=r*r+n*n;0!==s&&(r*=o=t/Math.sqrt(s),n*=o,i.x+=r,i.y+=n,e.x-=r,e.y-=n)}function W(e,i){E===e?d+=i:(D(),E=e,d=i)}function D(){d&&((p=function(e){if(null==j[e])return j[e]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==L&&j[e].setAttribute("shape-rendering","crispEdges"),j[e];return j[e]}(k++)).setAttribute("d",d),p.setAttribute("style",E),S.appendChild(p)),d="",E=""}this.domElement=S,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.overdraw=.5,this.info={render:{vertices:0,faces:0}},this.setQuality=function(e){switch(e){case"high":L=1;break;case"low":L=0}},this.setClearColor=function(e){w.set(e)},this.setPixelRatio=function(){},this.setSize=function(e,i){n=(o=e)/2,s=(r=i)/2,S.setAttribute("viewBox",-n+" "+-s+" "+o+" "+r),S.setAttribute("width",o),S.setAttribute("height",r),y.min.set(-n,-s),y.max.set(n,s)},this.setPrecision=function(e){V=e},this.clear=function(){P(),S.style.backgroundColor=w.getStyle()},this.render=function(o,r){if(r instanceof THREE.Camera!=!1){var p=o.background;p&&p.isColor?(P(),S.style.backgroundColor=p.getStyle()):!0===this.autoClear&&this.clear(),f.info.render.vertices=0,f.info.render.faces=0,C.copy(r.matrixWorldInverse),z.multiplyMatrices(r.projectionMatrix,C),e=h.projectScene(o,r,this.sortObjects,this.sortElements),i=e.elements,t=e.lights,M.getNormalMatrix(r.matrixWorldInverse),function(e){v.setRGB(0,0,0),R.setRGB(0,0,0),g.setRGB(0,0,0);for(var i=0,t=e.length;i<t;i++){var o=e[i],r=o.color;o.isAmbientLight?(v.r+=r.r,v.g+=r.g,v.b+=r.b):o.isDirectionalLight?(R.r+=r.r,R.g+=r.g,R.b+=r.b):o.isPointLight&&(g.r+=r.r,g.g+=r.g,g.b+=r.b)}}(t),d="",E="";for(var m=0,x=i.length;m<x;m++){var w=i[m],T=w.material;if(void 0!==T&&0!==T.opacity)if(u.makeEmpty(),w instanceof THREE.RenderableSprite)(a=w).x*=n,a.y*=-s,G(a,w,T);else if(w instanceof THREE.RenderableLine)a=w.v1,c=w.v2,a.positionScreen.x*=n,a.positionScreen.y*=-s,c.positionScreen.x*=n,c.positionScreen.y*=-s,u.setFromPoints([a.positionScreen,c.positionScreen]),!0===y.intersectsBox(u)&&O(a,c,w,T);else if(w instanceof THREE.RenderableFace){if(a=w.v1,c=w.v2,l=w.v3,a.positionScreen.z<-1||a.positionScreen.z>1)continue;if(c.positionScreen.z<-1||c.positionScreen.z>1)continue;if(l.positionScreen.z<-1||l.positionScreen.z>1)continue;a.positionScreen.x*=n,a.positionScreen.y*=-s,c.positionScreen.x*=n,c.positionScreen.y*=-s,l.positionScreen.x*=n,l.positionScreen.y*=-s,this.overdraw>0&&(A(a.positionScreen,c.positionScreen,this.overdraw),A(c.positionScreen,l.positionScreen,this.overdraw),A(l.positionScreen,a.positionScreen,this.overdraw)),u.setFromPoints([a.positionScreen,c.positionScreen,l.positionScreen]),!0===y.intersectsBox(u)&&F(a,c,l,w,T)}}D(),o.traverseVisible((function(e){if(e instanceof THREE.SVGObject){if(b.setFromMatrixPosition(e.matrixWorld),b.applyMatrix4(z),b.z<-1||b.z>1)return;var i=b.x*n,t=-b.y*s,o=e.node;o.setAttribute("transform","translate("+i+","+t+")"),S.appendChild(o)}}))}else console.error("THREE.SVGRenderer.render: camera is not an instance of THREE.Camera.")}}
